<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>cat-oscilloscope ç°¡æ˜“ãƒ‡ãƒ¢ - ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåˆ©ç”¨ä¾‹</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      background: #0a0a0a;
      color: #e0e0e0;
    }
    h1 {
      color: #00ff00;
      text-align: center;
      margin-bottom: 10px;
    }
    .subtitle {
      text-align: center;
      color: #888;
      margin-bottom: 30px;
    }
    canvas {
      border: 2px solid #00ff00;
      display: block;
      margin: 20px auto;
      background: #000;
    }
    .controls {
      text-align: center;
      margin: 20px 0;
    }
    button {
      background: #00ff00;
      border: none;
      color: #000;
      padding: 12px 24px;
      margin: 5px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      border-radius: 6px;
      transition: background 0.2s;
    }
    button:hover:not(:disabled) {
      background: #00dd00;
    }
    button:disabled {
      background: #555;
      cursor: not-allowed;
      opacity: 0.5;
    }
    .info-panel {
      background: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      border: 1px solid #333;
    }
    .info-panel h3 {
      color: #00ff00;
      margin-top: 0;
    }
    .status-display {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      margin: 15px 0;
    }
    .status-item {
      margin: 10px;
    }
    .status-label {
      color: #888;
      font-size: 14px;
    }
    .status-value {
      color: #00ff00;
      font-weight: bold;
      font-size: 20px;
    }
    code {
      background: #222;
      padding: 2px 6px;
      border-radius: 3px;
      color: #00ff00;
      font-family: 'Courier New', monospace;
    }
    pre {
      background: #222;
      padding: 15px;
      border-radius: 6px;
      overflow-x: auto;
      border: 1px solid #333;
    }
    a {
      color: #00ff00;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .note {
      background: #1a2a1a;
      border-left: 4px solid #00ff00;
      padding: 12px;
      margin: 15px 0;
      border-radius: 4px;
    }
    .wave-selector {
      margin: 20px 0;
      text-align: center;
    }
    .wave-selector label {
      display: inline-block;
      margin: 0 10px;
      cursor: pointer;
    }
    .wave-selector input[type="radio"] {
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <div style="text-align: center; margin-bottom: 15px; padding-top: 10px;">
    <a href="index.html" style="color: #00ff00; text-decoration: none; padding: 8px 16px; border: 2px solid #00ff00; border-radius: 4px; display: inline-block; font-size: 14px;">
      â† ãƒ•ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¸æˆ»ã‚‹
    </a>
  </div>
  <h1>ğŸ± cat-oscilloscope ç°¡æ˜“ãƒ‡ãƒ¢</h1>
  <p class="subtitle">ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã™æœ€å°é™ã®ã‚µãƒ³ãƒ—ãƒ«</p>
  
  <div class="info-panel">
    <h3>ğŸ“˜ ã“ã®ãƒ‡ãƒ¢ã«ã¤ã„ã¦</h3>
    <p>
      ã“ã®ãƒšãƒ¼ã‚¸ã¯ã€cat-oscilloscopeã‚’npmãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã™<strong>æœ€å°é™ã®å®Ÿè£…ä¾‹</strong>ã§ã™ã€‚
      CDNï¼ˆjsDelivrï¼‰çµŒç”±ã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã¿ã€BufferSourceã‚’ä½¿ã£ã¦æ³¢å½¢ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã—ã¦ã„ã¾ã™ã€‚
    </p>
    <div class="note">
      <strong>ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆï¼š</strong> ã“ã®ãƒ‡ãƒ¢ã¯<code>BufferSource</code>ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€
      ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªå†ç”Ÿãªã—ã§æ³¢å½¢ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã§ãã¾ã™ã€‚ã“ã‚Œã¯wavlpfã®ã‚ˆã†ãªéŸ³å£°å‡¦ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã®çµ±åˆã«æœ€é©ã§ã™ã€‚
    </div>
    <div class="note">
      <strong>âœ… æ©Ÿèƒ½ã‚µãƒãƒ¼ãƒˆï¼š</strong> BufferSourceãƒ¢ãƒ¼ãƒ‰ã¯ã€ãƒ¡ã‚¤ãƒ³ç‰ˆã®ãƒã‚¤ã‚¯/ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ã¨
      <strong>å®Œå…¨ã«åŒç­‰ã®æ©Ÿèƒ½</strong>ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ï¼ˆå‘¨æ³¢æ•°æ¨å®šã€è‡ªå‹•ã‚²ã‚¤ãƒ³ã€ãƒã‚¤ã‚ºã‚²ãƒ¼ãƒˆã€
      FFTè¡¨ç¤ºã€å€éŸ³åˆ†æãªã©ï¼‰ã€‚å®Ÿè£…æ–¹æ³•ãŒç•°ãªã‚‹ã ã‘ã§ã€å¯è¦–åŒ–çµæœã¯åŒä¸€ã§ã™ã€‚
    </div>
  </div>

  <canvas id="oscilloscope" width="800" height="400"></canvas>
  
  <div class="wave-selector">
    <strong>æ³¢å½¢é¸æŠï¼š</strong>
    <label>
      <input type="radio" name="waveform" value="440" checked>
      440Hz ã‚µã‚¤ãƒ³æ³¢
    </label>
    <label>
      <input type="radio" name="waveform" value="880">
      880Hz ã‚µã‚¤ãƒ³æ³¢
    </label>
    <label>
      <input type="radio" name="waveform" value="220">
      220Hz ã‚µã‚¤ãƒ³æ³¢
    </label>
    <label>
      <input type="radio" name="waveform" value="complex">
      è¤‡åˆæ³¢å½¢ï¼ˆ440Hz + 880Hzï¼‰
    </label>
  </div>

  <div class="controls">
    <button id="startBtn">æ³¢å½¢è¡¨ç¤ºé–‹å§‹</button>
    <button id="stopBtn" disabled>åœæ­¢</button>
  </div>

  <div class="info-panel">
    <h3>ğŸ“Š ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h3>
    <div class="status-display">
      <div class="status-item">
        <div class="status-label">çŠ¶æ…‹</div>
        <div class="status-value" id="status">å¾…æ©Ÿä¸­</div>
      </div>
      <div class="status-item">
        <div class="status-label">æ¨å®šå‘¨æ³¢æ•°</div>
        <div class="status-value" id="frequency">--- Hz</div>
      </div>
      <div class="status-item">
        <div class="status-label">ã‚²ã‚¤ãƒ³</div>
        <div class="status-value" id="gain">---x</div>
      </div>
    </div>
  </div>

  <div class="info-panel">
    <h3>ğŸ’» å®Ÿè£…ã‚³ãƒ¼ãƒ‰</h3>
    <p>ã“ã®ãƒ‡ãƒ¢ã®ã‚³ã‚¢ã¨ãªã‚‹å®Ÿè£…ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š</p>
    <pre><code>// CDNçµŒç”±ã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import { Oscilloscope, BufferSource } from 
  'https://cdn.jsdelivr.net/gh/cat2151/cat-oscilloscope@main/dist/cat-oscilloscope.mjs';

// Oscilloscopeã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
const canvas = document.getElementById('oscilloscope');

// ä»–ã®ãƒ“ãƒ¥ãƒ¼ç”¨ã®hidden canvasã‚’ä½œæˆ
const hiddenCanvas = document.createElement('canvas');
hiddenCanvas.width = 250;
hiddenCanvas.height = 120;

const oscilloscope = new Oscilloscope(
  canvas,
  hiddenCanvas,  // previousWaveformCanvas
  hiddenCanvas,  // currentWaveformCanvas
  hiddenCanvas,  // similarityPlotCanvas
  hiddenCanvas   // frameBufferCanvas
);

// 440Hz ã‚µã‚¤ãƒ³æ³¢ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
const sampleRate = 44100;
const duration = 1; // ç§’
const frequency = 440; // Hz
const audioData = new Float32Array(sampleRate * duration);

for (let i = 0; i &lt; audioData.length; i++) {
  audioData[i] = Math.sin(2 * Math.PI * frequency * i / sampleRate);
}

// BufferSourceã‚’ä½œæˆã—ã¦ãƒ«ãƒ¼ãƒ—å†ç”Ÿ
const bufferSource = new BufferSource(audioData, sampleRate, { 
  loop: true 
});

// å¯è¦–åŒ–ã‚’é–‹å§‹
await oscilloscope.startFromBuffer(bufferSource);

// æ¨å®šå‘¨æ³¢æ•°ã‚’å–å¾—
const estimatedFreq = oscilloscope.getEstimatedFrequency();
console.log(\`æ¨å®šå‘¨æ³¢æ•°: \${estimatedFreq} Hz\`);</code></pre>
  </div>

  <div class="info-panel">
    <h3>ğŸ”— è©³ç´°ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</h3>
    <ul>
      <li><a href="https://github.com/cat2151/cat-oscilloscope/blob/main/LIBRARY_USAGE.md">ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåˆ©ç”¨æ–¹æ³•ï¼ˆLIBRARY_USAGE.mdï¼‰</a></li>
      <li><a href="https://github.com/cat2151/cat-oscilloscope/blob/main/README.ja.md">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèª¬æ˜ï¼ˆREADME.ja.mdï¼‰</a></li>
      <li><a href="https://github.com/cat2151/cat-oscilloscope">GitHubãƒªãƒã‚¸ãƒˆãƒª</a></li>
      <li><a href="https://cat2151.github.io/cat-oscilloscope/">ãƒ•ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ‡ãƒ¢</a></li>
    </ul>
  </div>

  <div class="info-panel">
    <h3>ğŸ“¦ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•</h3>
    <p><strong>CDNçµŒç”±ï¼ˆæœ€ã‚‚ç°¡å˜ï¼‰ï¼š</strong></p>
    <pre><code>&lt;script type="module"&gt;
  import { Oscilloscope, BufferSource } from 
    'https://cdn.jsdelivr.net/gh/cat2151/cat-oscilloscope@main/dist/cat-oscilloscope.mjs';
&lt;/script&gt;</code></pre>
    
    <p><strong>npmçµŒç”±ï¼š</strong></p>
    <pre><code>npm install git+https://github.com/cat2151/cat-oscilloscope.git</code></pre>
    
    <div class="note">
      <strong>âš ï¸ æ³¨æ„ï¼š</strong> npmçµŒç”±ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å ´åˆã¯ã€WASMãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå¿…è¦ã§ã™ã€‚
      è©³ç´°ã¯<a href="https://github.com/cat2151/cat-oscilloscope/blob/main/LIBRARY_USAGE.md#-é‡è¦-wasmãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—">LIBRARY_USAGE.md</a>ã‚’ã”è¦§ãã ã•ã„ã€‚
    </div>
  </div>

  <script type="module" src="./demo-simple.js"></script>
</body>
</html>
