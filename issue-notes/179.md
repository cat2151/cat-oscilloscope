# issue micで人の声を入力すると、類似度0のスパイクが1秒に10回前後発生していることが判明した。load wav fileで単純波形を入力した場合は問題ない。仮説を洗い出す #179
[issues #179](https://github.com/cat2151/cat-oscilloscope/issues/179)

## 分析結果

詳細な分析結果は [179-analysis.md](./179-analysis.md) を参照してください。

### 主な仮説（優先度順）

1. **周波数推定の不安定性（最も可能性が高い）**
   - 人の声は複雑で非周期的な信号であり、周波数が急変する
   - 周波数が変化すると cycle_length が変化し、前回の波形長と一致しなくなり類似度が0になる
   - 修正案: サイクル長の許容範囲導入、周波数推定のスムージング強化

2. **ノイズゲートによる信号カット**
   - 音量変動でノイズゲート閾値を下回り、信号が0で埋められる
   - 修正案: ノイズゲート適用後も前回の波形情報を保持

3. **バッファサイズ不足**
   - 低周波の人声に対して4サイクル分のバッファが不足する可能性
   - 検証: バッファサイズマルチプライヤーの設定確認

4. **自動ゲイン制御の影響**
   - 波形の振幅が急激に変化し、相関係数の計算が不安定になる可能性

5. **ゼロクロス検出の失敗**
   - 類似度検索失敗時のフォールバック処理が不安定

