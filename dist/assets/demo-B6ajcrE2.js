import"./modulepreload-polyfill-B5Qt9EMX.js";import{Oscilloscope as E,BufferSource as y}from"https://cdn.jsdelivr.net/gh/cat2151/cat-oscilloscope@main/dist/cat-oscilloscope.mjs";const g=document.getElementById("oscilloscope"),l=document.getElementById("startBtn"),u=document.getElementById("stopBtn"),i=document.getElementById("status"),f=document.getElementById("frequency"),m=document.getElementById("gain"),h=document.querySelectorAll('input[name="waveform"]'),s=document.createElement("canvas");s.width=250;s.height=120;const c=new E(g,s,s,s,s);c.setDebugOverlaysEnabled(!1);let d=null;function p(){d=setInterval(()=>{const e=c.getEstimatedFrequency();f.textContent=e>0?`${e.toFixed(1)} Hz`:"--- Hz";const n=c.getCurrentGain();m.textContent=`${n.toFixed(2)}x`},100)}function v(){d&&(clearInterval(d),d=null),f.textContent="--- Hz",m.textContent="---x"}function b(e,n=44100,r=1){const o=new Float32Array(n*r),a=o.length;switch(e){case"440":for(let t=0;t<a;t++)o[t]=Math.sin(2*Math.PI*440*t/n);break;case"880":for(let t=0;t<a;t++)o[t]=Math.sin(2*Math.PI*880*t/n);break;case"220":for(let t=0;t<a;t++)o[t]=Math.sin(2*Math.PI*220*t/n);break;case"complex":for(let t=0;t<a;t++)o[t]=.5*Math.sin(2*Math.PI*440*t/n)+.3*Math.sin(2*Math.PI*880*t/n);break}return o}l.addEventListener("click",async()=>{try{l.disabled=!0,i.textContent="初期化中...";const e=document.querySelector('input[name="waveform"]:checked');if(!e)throw new Error("波形が選択されていません");const n=e.value,r=44100,o=b(n,r,1),a=new y(o,r,{loop:!0});await c.startFromBuffer(a),i.textContent="実行中",u.disabled=!1,p(),h.forEach(t=>t.disabled=!0)}catch(e){console.error("Failed to start oscilloscope:",e),i.textContent="エラー",l.disabled=!1}});u.addEventListener("click",async()=>{try{await c.stop(),i.textContent="停止",l.disabled=!1,u.disabled=!0,v(),h.forEach(e=>e.disabled=!1)}catch(e){console.error("Failed to stop oscilloscope:",e)}});
//# sourceMappingURL=demo-B6ajcrE2.js.map
