import"./modulepreload-polyfill-B5Qt9EMX.js";import{Oscilloscope as E,BufferSource as p}from"https://cdn.jsdelivr.net/gh/cat2151/cat-oscilloscope@main/dist/cat-oscilloscope.mjs";const y=document.getElementById("oscilloscope"),d=document.getElementById("startBtn"),u=document.getElementById("stopBtn"),l=document.getElementById("status"),m=document.getElementById("frequency"),h=document.getElementById("gain"),g=document.querySelectorAll('input[name="waveform"]'),a=document.createElement("canvas");a.width=250;a.height=120;const c=new E(y,a,a,a,a);c.setDebugOverlaysEnabled(!1);let i=null;function v(){i=setInterval(()=>{const e=c.getEstimatedFrequency();m.textContent=e>0?`${e.toFixed(1)} Hz`:"--- Hz";const n=c.getCurrentGain();h.textContent=`${n.toFixed(2)}x`},100)}function b(){i&&(clearInterval(i),i=null),m.textContent="--- Hz",h.textContent="---x"}function w(e,n=44100,r=1){const o=new Float32Array(n*r),s=o.length;switch(e){case"440":for(let t=0;t<s;t++)o[t]=Math.sin(2*Math.PI*440*t/n);break;case"880":for(let t=0;t<s;t++)o[t]=Math.sin(2*Math.PI*880*t/n);break;case"220":for(let t=0;t<s;t++)o[t]=Math.sin(2*Math.PI*220*t/n);break;case"complex":for(let t=0;t<s;t++)o[t]=.5*Math.sin(2*Math.PI*440*t/n)+.3*Math.sin(2*Math.PI*880*t/n);break}return o}async function f(){try{d.disabled=!0,l.textContent="初期化中...";const e=document.querySelector('input[name="waveform"]:checked');if(!e)throw new Error("波形が選択されていません");const n=e.value,r=44100,o=w(n,r,1),s=new p(o,r,{loop:!0});await c.startFromBuffer(s),l.textContent="実行中",u.disabled=!1,v(),g.forEach(t=>t.disabled=!0)}catch(e){console.error("Failed to start oscilloscope:",e),l.textContent="エラー",d.disabled=!1}}d.addEventListener("click",f);u.addEventListener("click",async()=>{try{await c.stop(),l.textContent="停止",d.disabled=!1,u.disabled=!0,b(),g.forEach(e=>e.disabled=!1)}catch(e){console.error("Failed to stop oscilloscope:",e)}});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{console.log("Auto-starting oscilloscope with 440Hz..."),f()}):(console.log("Auto-starting oscilloscope with 440Hz..."),f());
//# sourceMappingURL=demo-DsYptmO3.js.map
